---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "imagefactory_template Resource - terraform-provider-imagefactory"
subcategory: ""
description: |-
  
---

# imagefactory_template (Resource)



## Example Usage

```terraform
// Copyright 2021-2023 Nordcloud Oy or its affiliates. All Rights Reserved.

resource "imagefactory_custom_component" "build_template" {
  name            = "Install nginx"
  description     = "Install nginx on Ubuntu"
  stage           = "BUILD"
  cloud_providers = ["AWS", "AZURE"]
  os_types        = ["LINUX"]
  content {
    script      = <<-EOT
      apt-get update && apt-get install nginx -y
    EOT
    provisioner = "SHELL"
  }
}

resource "imagefactory_custom_component" "test_component" {
  name            = "Test nginx"
  description     = "Test nginx is installed"
  stage           = "TEST"
  cloud_providers = ["AWS", "AZURE"]
  os_types        = ["LINUX"]
  content {
    script      = <<-EOT
      ps aux | grep nginx
      systemctl is-active --quiet nginx || echo "nginx is not running"; exit 1
    EOT
    provisioner = "SHELL"
  }
}

data "imagefactory_system_component" "hardening-level-1" {
  name           = "Hardening level 1"
  cloud_provider = "AWS"
  stage          = "BUILD"
}

data "imagefactory_distribution" "ubuntu18" {
  name           = "Ubuntu Server 18.04 LTS"
  cloud_provider = "AWS"
}

resource "imagefactory_template" "template" {
  name            = "Ubuntu1804"
  description     = "Ubuntu 18.04 on AWS"
  cloud_provider  = "AWS"
  distribution_id = data.imagefactory_distribution.ubuntu18.id
  config {
    aws {
      region = "eu-west-1"
    }
    build_components {
      id = data.imagefactory_system_component.hardening-level-1.id
    }
    build_components {
      id = imagefactory_custom_component.build_template.id
    }
    test_components {
      id = imagefactory_custom_component.test_component.id
    }
    notifications {
      type = "SNS"
      uri  = "arn:aws:sns:eu-west-1:123456789012:Topic"
    }
    tags {
      key   = "KEY_ONE"
      value = "VALUE_A"
    }
    tags {
      key   = "KEY_TWO"
      value = "VALUE_B"
    }
  }
}

output "template" {
  value = imagefactory_template.template
}

# AZURE Template

data "imagefactory_distribution" "ubuntu18" {
  name           = "Ubuntu Server 18.04 LTS"
  cloud_provider = "AZURE"
}

resource "imagefactory_template" "azure_template" {
  name            = "Ubuntu1804"
  description     = "Ubuntu 18.04 on Azure"
  cloud_provider  = "AZURE"
  distribution_id = data.imagefactory_distribution.ubuntu18.id
  config {
    azure {
      exclude_from_latest = true
      eol_date_option     = true
      replica_regions     = ["westeurope"]
      vm_image_definition {
        name  = "Ubuntu1804"
        offer = "ubuntu-18_04-lts"
        sku   = "v1"
      }
    }
    notifications {
      type = "WEB_HOOK"
      uri  = "https://webhook.call.api.address"
    }
    tags {
      key   = "KEY_ONE"
      value = "VALUE_A"
    }
    tags {
      key   = "KEY_TWO"
      value = "VALUE_B"
    }
  }
}

output "azure_template" {
  value = imagefactory_template.azure_template
}

# AWS CHINA template

resource "imagefactory_template" "aws_china_template" {
  name            = "Ubuntu1804"
  description     = "Ubuntu 18.04 on AWS"
  cloud_provider  = "AWS"
  distribution_id = data.imagefactory_distribution.ubuntu18.id
  config {
    scope = "CHINA"
  }
}

# AWS template - copy image to selected account

resource "imagefactory_aws_account" "aws_account" {
  alias       = "IF AWS Account"
  description = "Account to distribute AWS images"
  account_id  = "123456789012"
  access {
    role_arn         = "arn:aws:iam::123456789012:role/ImageFactoryMasterRole"
    role_external_id = "lieGhohY6ahv2aijieZ9"
  }
}

data "imagefactory_distribution" "ubuntu18" {
  name           = "Ubuntu Server 18.04 LTS"
  cloud_provider = "AWS"
}

resource "imagefactory_template" "aws_template" {
  name            = "Ubuntu1804"
  description     = "Ubuntu 18.04 on AWS"
  cloud_provider  = "AWS"
  distribution_id = data.imagefactory_distribution.ubuntu18.id
  config {
    aws {
      region = "eu-west-1"
    }
    build_components {
      id = data.imagefactory_system_component.hardening-level-1.id
    }
    cloud_account_ids = [imagefactory_aws_account.aws_account.id]
  }
}

# EXOSCALE Template

data "imagefactory_distribution" "ubuntu22" {
  name           = "Ubuntu Server 22.04 LTS"
  cloud_provider = "EXOSCALE"
}

resource "imagefactory_template" "exoscale_template" {
  name            = "Ubuntu2204"
  description     = "Ubuntu Server 22.04 on Exoscale"
  cloud_provider  = "EXOSCALE"
  distribution_id = data.imagefactory_distribution.ubuntu22.id
  config {
    exoscale {
      zone = "de-fra-1"
    }
    notifications {
      type = "WEB_HOOK"
      uri  = "https://webhook.call.api.address"
    }
  }
}

output "template" {
  value = imagefactory_template.exoscale_template
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cloud_provider` (String)
- `distribution_id` (String)
- `name` (String)

### Optional

- `config` (Block List) (see [below for nested schema](#nestedblock--config))
- `description` (String)

### Read-Only

- `id` (String) The ID of this resource.
- `state` (Map of String)

<a id="nestedblock--config"></a>
### Nested Schema for `config`

Optional:

- `aws` (Block List) (see [below for nested schema](#nestedblock--config--aws))
- `azure` (Block List) (see [below for nested schema](#nestedblock--config--azure))
- `build_components` (Block List) (see [below for nested schema](#nestedblock--config--build_components))
- `cloud_account_ids` (List of String)
- `exoscale` (Block List) (see [below for nested schema](#nestedblock--config--exoscale))
- `notifications` (Block List) (see [below for nested schema](#nestedblock--config--notifications))
- `scope` (String)
- `tags` (Block List) (see [below for nested schema](#nestedblock--config--tags))
- `test_components` (Block List) (see [below for nested schema](#nestedblock--config--test_components))

<a id="nestedblock--config--aws"></a>
### Nested Schema for `config.aws`

Optional:

- `custom_image_name` (String)
- `region` (String)


<a id="nestedblock--config--azure"></a>
### Nested Schema for `config.azure`

Optional:

- `eol_date_option` (Boolean) Default value is set to true
- `exclude_from_latest` (Boolean)
- `replica_regions` (List of String)
- `vm_image_definition` (Block List) (see [below for nested schema](#nestedblock--config--azure--vm_image_definition))

<a id="nestedblock--config--azure--vm_image_definition"></a>
### Nested Schema for `config.azure.vm_image_definition`

Required:

- `name` (String)
- `offer` (String)
- `sku` (String)



<a id="nestedblock--config--build_components"></a>
### Nested Schema for `config.build_components`

Read-Only:

- `id` (String) The ID of this resource.


<a id="nestedblock--config--exoscale"></a>
### Nested Schema for `config.exoscale`

Required:

- `zone` (String)


<a id="nestedblock--config--notifications"></a>
### Nested Schema for `config.notifications`

Required:

- `type` (String)
- `uri` (String)


<a id="nestedblock--config--tags"></a>
### Nested Schema for `config.tags`

Required:

- `key` (String)
- `value` (String)


<a id="nestedblock--config--test_components"></a>
### Nested Schema for `config.test_components`

Read-Only:

- `id` (String) The ID of this resource.

## Import

Import is supported using the following syntax:

```shell
terraform import imagefactory_template.tf_name RESOURCE_ID
```
